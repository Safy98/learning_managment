<article id="<%= dom_id course %>" class="overflow-hidden rounded-2xl border border-brown-200 bg-white shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-xl">
  <%= link_to course, class: "flex h-full flex-col" do %>
    <% if course.image.present? %>
      <%= image_tag course.image, class: "h-52 w-full object-cover" %>
    <% else %>
      <%= image_tag "https://via.placeholder.com/380x220", class: "h-52 w-full object-cover" %>
    <% end %>

    <div class="flex grow flex-col justify-between p-5">
      <div>
        <div class="mb-2 flex items-start justify-between gap-3">
          <h2 class="text-xl font-bold text-gray-900"><%= course.title %></h2>
          <% if user_unlocked_courses&.include?(course.id) %>
            <span class="rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-700">Unlocked</span>
          <% end %>
        </div>
        <p class="text-sm text-gray-500">Conner Jensen</p>
        <p class="mt-2 text-sm font-semibold text-amaranth-800"><%= course.paid ? "Premium Content" : "Free" %></p>
      </div>

      <% if user_started_courses&.include?(course.id) %>
        <% user_completed_percentage = user_course_progresses.find { |cp| cp[:course_id] == course.id }[:completed_percentage] %>
        <div class="mt-5">
          <div class="mb-1 text-xs font-semibold uppercase tracking-wide text-gray-500">Progress</div>
          <div class="relative h-3 overflow-hidden rounded-full bg-brown-100">
            <% if user_completed_percentage == 100 %>
              <div class="absolute h-full rounded-full bg-green-500 text-center text-[10px] font-semibold leading-3 text-white-50" style="width: 100%">Done</div>
            <% else %>
              <div class="absolute h-full rounded-full bg-green-500 text-center text-[10px] font-semibold leading-3 text-white-50" style="width: <%= user_completed_percentage %>%"><%= user_completed_percentage %>%</div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</article>
