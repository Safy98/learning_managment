<div class="flex flex-col justify-start items-center w-full">
  <% if notice.present? %>
    <p class="ui-notice"><%= notice %></p>
  <% end %>

  <h1 class="page-title mb-4 w-full">User #<%= @admin_user.id %></h1>

  <div class="my-4">
    <%= render @admin_user %>
  </div>

  <div class="mb-6 flex flex-wrap gap-2">
    <%= link_to "Back to users", admin_users_path, class: "ui-btn ui-btn-accent" %>
    <%= button_to "Destroy this user", [:admin, @admin_user], method: :delete, data: { "turbo-confirm": "Are you sure?" }, class: "ui-btn ui-btn-danger cursor-pointer" %>
  </div>

  <div>
    <h2 class="mb-3 text-lg font-semibold">User Started Courses</h2>
    <div class="ui-table-wrap">
      <table class="ui-table">
        <thead>
          <tr>
            <th>Course Title</th>
            <th>Completed Percentage</th>
            <th>Paid</th>
          </tr>
        </thead>
        <tbody>
        <% @admin_courses.each do |course| %>
          <% user_completed_percentage = @user_course_progresses.find {|cp| cp[:course_id] == course.id}[:completed_percentage] %>
          <% user_paid = @admin_user.course_users.any?{|cu| cu.course_id == course.id } %>
          <tr>
            <td><%= course.title %></td>
            <td><%= user_completed_percentage %></td>
            <td><%= user_paid ? (icon("fa-solid", "money-bill", class: "text-green-600")) : icon("fa-regular", "circle-xmark", class: "text-red-600") %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
